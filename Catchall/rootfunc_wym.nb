(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13252,        338]
NotebookOptionsPosition[     12508,        309]
NotebookOutlinePosition[     12867,        325]
CellTagsIndexPosition[     12824,        322]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6646645598779984`*^9, 3.664664572022735*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mtot", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k11", " ", "=", " ", "3.914"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l20", " ", "=", " ", "313.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k21", " ", "=", " ", "2.951"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k22", " ", "=", " ", "0.1136"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ligrange", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "0.01", ",", "0.02", ",", "0.03", ",", "0.05", ",", "0.08", ",", "0.1", 
     ",", "0.2", ",", "0.3", ",", "0.5", ",", "0.8", ",", "1.0", ",", "2.0", 
     ",", "3.0", ",", "5.0", ",", "8.0", ",", "10.0"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.664664599808908*^9, 3.664664626358904*^9}, {
  3.6646651584599953`*^9, 3.664665159835745*^9}, {3.664665660206452*^9, 
  3.664665679428689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.664664640791912*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cons", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mtot", " ", "\[Equal]", " ", 
      RowBox[{"x2", " ", "+", " ", 
       RowBox[{"2", "x3"}], "+", "x4", "+", 
       RowBox[{"2", "x5"}], "+", 
       RowBox[{"2", "x6"}]}]}], ",", " ", 
     RowBox[{"ltot", "\[Equal]", " ", 
      RowBox[{"x1", "+", "x4", "+", "x5", "+", 
       RowBox[{"2", "x6"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.6646647281637087`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"equ", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x3", "\[Equal]", 
      RowBox[{"l20", " ", 
       RowBox[{"x2", "^", "2"}]}]}], ",", " ", 
     RowBox[{"x4", "\[Equal]", 
      RowBox[{"k11", " ", "x1", " ", "x2"}]}], ",", " ", 
     RowBox[{"x5", "\[Equal]", 
      RowBox[{"l20", " ", "k21", " ", 
       RowBox[{"x2", "^", "2"}], " ", "x1"}]}], ",", " ", 
     RowBox[{"x6", "\[Equal]", 
      RowBox[{"l20", " ", "k21", " ", "k22", " ", 
       RowBox[{"x2", "^", "2"}], " ", 
       RowBox[{"x1", "^", "2"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664664667591277*^9, 3.664664670685719*^9}, 
   3.664664718276287*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sys", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"cons", ",", "equ"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.664664713339746*^9, {3.664664819563909*^9, 3.664664821379509*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subfunc", "[", "a_", "]"}], ":=", " ", 
  RowBox[{"sys", "/.", " ", 
   RowBox[{"ltot", " ", "\[Rule]", " ", "a"}]}]}]], "Input",
 CellChangeTimes->{{3.664664867936327*^9, 3.664664876119425*^9}, {
   3.664664908189516*^9, 3.664664921821479*^9}, 3.6646649672366953`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"subfunc", "[", "0.1", "]"}]], "Input",
 CellChangeTimes->{{3.664664975783741*^9, 3.6646649835325193`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "\[Equal]", 
    RowBox[{"x2", "+", 
     RowBox[{"2", " ", "x3"}], "+", "x4", "+", 
     RowBox[{"2", " ", "x5"}], "+", 
     RowBox[{"2", " ", "x6"}]}]}], ",", 
   RowBox[{"0.1`", "\[Equal]", 
    RowBox[{"x1", "+", "x4", "+", "x5", "+", 
     RowBox[{"2", " ", "x6"}]}]}], ",", 
   RowBox[{"x3", "\[Equal]", 
    RowBox[{"313.9`", " ", 
     SuperscriptBox["x2", "2"]}]}], ",", 
   RowBox[{"x4", "\[Equal]", 
    RowBox[{"3.914`", " ", "x1", " ", "x2"}]}], ",", 
   RowBox[{"x5", "\[Equal]", 
    RowBox[{"926.3189`", " ", "x1", " ", 
     SuperscriptBox["x2", "2"]}]}], ",", 
   RowBox[{"x6", "\[Equal]", 
    RowBox[{"105.22982704`", " ", 
     SuperscriptBox["x1", "2"], " ", 
     SuperscriptBox["x2", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.664664983942808*^9, 3.664665436644059*^9, 3.664665542390942*^9, 
   3.664665611050585*^9, {3.664665666708132*^9, 3.6646656863768787`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rootfunc", "[", "a_", "]"}], ":=", " ", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"subfunc", "[", "a", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x3", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x4", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x5", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x6", ",", "10"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.664664991367968*^9, 3.664665043803226*^9}, {
  3.6646654753874903`*^9, 3.664665490009364*^9}, {3.6646655798959637`*^9, 
  3.664665593607522*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rootfunc", "/@", "ligrange"}]], "Input",
 CellChangeTimes->{{3.6646654143935957`*^9, 3.664665426062018*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.003914645653329907`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.03889070593737056`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.4747696719075765`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.0005958804051766836`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.005484595900806294`"}], ",", 
     RowBox[{"x6", "\[Rule]", "2.4390203435574252`*^-6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.007879378927612058`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.03866006946382092`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.469155244780407`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.0011922722557390138`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.010908819902977169`"}], ",", 
     RowBox[{"x6", "\[Rule]", "9.764456835880116`*^-6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.011894450020382082`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.03843032911909782`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.4635958325878627`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.0017891192598037896`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.016272455725558865`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.000021987497127631647`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.020076525998601297`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.03797363504760412`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.45264284534491633`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.0029839501194471488`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.026817200261164482`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.00006116181039353696`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.032732487968883055`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.03729592176167135`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.4366304363585458`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.004778165446718946`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.04217569349012002`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.00015682654713899255`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.041426969184707556`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.03684927164550111`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.4262350228503542`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.005974930950627779`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.05210765183849806`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.00024522401308330554`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.08801232678831515`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.0346844313311357`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.37762476892630353`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.011948101473719847`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.09807835760457238`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.000980607066696312`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.13976690299110325`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.032647054454479976`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.33456408865343173`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.0178594946899502`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.1379916712297598`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.002190965544593366`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.2579678494553955`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.029000434415159176`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.26399780910850906`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.029281337343259238`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.2009717968232181`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.0058895081890635685`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.4660638468804683`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.024605315867053303`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.19004183048319223`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.04488437492449467`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.26137487004703036`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.013838454074003366`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.6200553067561492`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.022298694680576152`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.15608105714122655`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.05411662342024876`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.28559449779311996`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.020116786015241084`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "1.4825908964090806`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.015281369683162615`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.07330200942361381`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.08867566062405945`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.32070550787869034`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.05401396754408478`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "2.409079901904841`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.011787440400217623`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.04361444349812745`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.11114541087663808`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.31006357450836824`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.08485555635507644`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "4.3223933337585505`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.008235744793284797`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.02129104983300693`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.13933107453032295`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.2715754892992522`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.133350051205937`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "7.248706565282787`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.005752317085084443`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.01038668476488454`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.16320150463961913`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.22218087866793346`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.1829555257048302`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "9.216504078240677`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.004806035001204501`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.007250453546656781`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.17337000841284078`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.19719713614615947`"}], ",", 
     RowBox[{"x6", "\[Rule]", "0.20646438860016114`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.664665436683063*^9, 3.664665542439392*^9, 3.664665611109132*^9, {
   3.6646656667509727`*^9, 3.6646656864212627`*^9}}]
}, Open  ]]
},
WindowSize->{1015, 651},
WindowMargins->{{12, Automatic}, {Automatic, 24}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 141, 2, 28, "Input"],
Cell[702, 24, 957, 23, 131, "Input"],
Cell[1662, 49, 222, 6, 28, "Input"],
Cell[1887, 57, 480, 13, 28, "Input"],
Cell[2370, 72, 692, 18, 28, "Input"],
Cell[3065, 92, 232, 6, 28, "Input"],
Cell[3300, 100, 304, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[3629, 110, 130, 2, 28, "Input"],
Cell[3762, 114, 957, 25, 57, "Output"]
}, Open  ]],
Cell[4734, 142, 792, 22, 28, "Input"],
Cell[CellGroupData[{
Cell[5551, 168, 132, 2, 28, "Input"],
Cell[5686, 172, 6806, 134, 358, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

